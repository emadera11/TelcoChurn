---
title: "Customer Churn Analysis"
output: 
    html_document:
        smart: false
---

Loading the necessary pacakges for this analysis: 

```{r messages=FALSE}

library(dplyr)
library(psych)
library(tidyr)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(caTools)
library(randomForest)
library(knitr)
library(rmarkdown)
library(markdown)
library(kableExtra)
library(gridExtra)


```
For this analysis i will predict customer churn using Logistic Regression, Decision Tree and Random Forest.   Data background information: 
THe data contains customer information such as if the customer is senior citizen, which product are they current enroll, 
monthly charges and total charges, amoung other variables that might be important for our prediction.  

The below tables contains information on what is stored in each variable.  This gives us the ability to guage 
on what the content of the data.   

```{r echo=FALSE} 
options(knitr.table.format = "html")
df  = read.csv("D:\\Emman\\Documents\\GitHub\\TelcoChurn\\ChurnAnalysis\\ChurnAnalysis\\datasource\\customerchurn.csv", na.strings = c("", "NA"))

kable(head(df)) %>%
     kable_styling(bootstrap_options = "striped",
                full_width = F) %>%
             scroll_box(width='100%')

```


Below table shows the description of each variable.    before we move further to clean the data and prepare the data for our models 
lets explore the data.   Below I used the summary function to describe the contents of the data.


```{r}
summary(df)                                                                  
```

```{r fig.width=20, fig.height=7}

a = ggplot(df, aes(MonthlyCharges)) +
    geom_histogram(color = "black", fill = "red", binwidth = 15, alpha = 0.5) +
    theme_bw()

b = ggplot(df, aes(TotalCharges)) +
    geom_histogram(color = "black", fill = "blue", alpha = 0.5, binwidth = 500) +
    theme_bw()

c = ggplot(df, aes(tenure)) +
    geom_histogram(color = "black", fill = "green", alpha = 0.5, binwidth = 5) +
    theme_bw()

grid.arrange(a, b, c, ncol=3)
```